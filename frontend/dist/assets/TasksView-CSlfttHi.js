import{bS as J,r as d,b as K,m as O,p as Q,d as i,o as n,f as e,k as j,h,v as W,bE as T,F as D,s as V,t as l,g as N,n as _,j as b,bR as m}from"./index-Bx6MUOaO.js";import{_ as X,a as Y}from"./ConfirmModal-CCvVDlHe.js";const Z={class:"min-h-screen bg-gray-50"},ee={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},te={class:"px-4 sm:px-0 mb-6"},se={class:"bg-white p-4 rounded-lg shadow"},ae={class:"grid grid-cols-1 gap-4 sm:grid-cols-4"},oe=["value"],re={class:"px-4 sm:px-0"},le={class:"bg-white shadow rounded-lg"},ie={class:"px-4 py-5 sm:p-6"},ne={key:0,class:"flex justify-center py-8"},de={key:1,class:"text-center py-8"},ue={class:"mt-1 text-sm text-gray-500"},ce={key:2,class:"overflow-hidden"},pe={class:"min-w-full divide-y divide-gray-200"},me={class:"bg-white divide-y divide-gray-200"},ge={class:"px-6 py-4"},ve={class:"flex items-center"},xe=["onClick"],ye={key:0,class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},fe={class:"min-w-0 flex-1"},he={class:"text-sm text-gray-500 mt-1 truncate"},_e={class:"px-6 py-4 whitespace-nowrap"},be={class:"flex items-center"},we={class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},ke={class:"text-xs font-medium text-primary-600"},Te={class:"ml-3"},Ce={class:"text-sm font-medium text-gray-900"},Se={class:"text-sm text-gray-500"},Fe={class:"px-6 py-4 whitespace-nowrap"},Me={class:"px-6 py-4 whitespace-nowrap"},$e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Ae={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ue=["onClick"],je=["onClick"],De={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Ve={class:"flex-1 flex justify-between sm:hidden"},Ne=["disabled"],Pe=["disabled"],Be={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Ee={class:"text-sm text-gray-700"},Le={class:"font-medium"},ze={class:"font-medium"},He={class:"font-medium"},Ie={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},Re=["disabled"],qe=["disabled"],Oe={__name:"TasksView",setup(Ge){const u=J(),w=d(!1),c=d([]),C=d([]),k=d(!1),g=d(!1),v=d(null),x=d(null),r=K({search:"",status:"",priority:"",user_id:""}),o=d({current_page:1,last_page:1,per_page:15,total:0,from:0,to:0}),P=O(()=>r.search||r.status||r.priority||r.user_id);let S=null;const B=()=>{clearTimeout(S),S=setTimeout(()=>{y()},300)},p=async(a=1)=>{w.value=!0;try{const t={page:a,...r},s=await m.getAdminTasks(t);s.data&&Array.isArray(s.data.data)?(c.value=s.data.data,o.value={current_page:s.data.current_page,last_page:s.data.last_page,per_page:s.data.per_page,total:s.data.total,from:s.data.from,to:s.data.to}):s.data&&Array.isArray(s.data)?(c.value=s.data,o.value={current_page:1,last_page:1,per_page:s.data.length,total:s.data.length,from:1,to:s.data.length}):(c.value=[],o.value={current_page:1,last_page:1,per_page:15,total:0,from:0,to:0})}catch(t){console.error("Failed to fetch tasks:",t),u.error("Failed to fetch tasks"),c.value=[],o.value={current_page:1,last_page:1,per_page:15,total:0,from:0,to:0}}finally{w.value=!1}},E=async()=>{try{const a=await m.getUsers();C.value=a.data}catch(a){console.error("Failed to fetch users:",a)}},y=()=>{p(1)},f=a=>{a>=1&&a<=o.value.last_page&&p(a)},L=async a=>{try{const t=await m.toggleTaskStatus(a.id);a.status=t.data.status,u.success(`Task marked as ${a.status}`)}catch(t){console.error("Failed to toggle task status:",t),u.error("Failed to update task status")}},z=a=>{v.value={...a},k.value=!0},F=()=>{k.value=!1,v.value=null},H=async a=>{try{await m.updateTask(v.value.id,a),u.success("Task updated successfully"),F(),p(o.value.current_page)}catch(t){console.error("Failed to update task:",t),u.error("Failed to update task")}},I=a=>{x.value=a,g.value=!0},R=async()=>{if(x.value)try{await m.deleteTask(x.value.id),u.success("Task deleted successfully"),g.value=!1,x.value=null,p(o.value.current_page)}catch(a){console.error("Failed to delete task:",a),u.error("Failed to delete task")}},q=a=>a?a.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().slice(0,2):"U",G=a=>a?new Date(a).toLocaleDateString():"N/A";return Q(()=>{p(),E()}),(a,t)=>(n(),i("div",Z,[e("div",ee,[t[25]||(t[25]=e("div",{class:"px-4 py-6 sm:px-0"},[e("div",{class:"border-b border-gray-200 pb-5"},[e("h1",{class:"text-3xl font-bold leading-6 text-gray-900"},"Tasks Management"),e("p",{class:"mt-2 max-w-4xl text-sm text-gray-500"}," Manage all system tasks across all users. ")])],-1)),e("div",te,[e("div",se,[e("div",ae,[e("div",null,[t[9]||(t[9]=e("label",{for:"search",class:"form-label"},"Search",-1)),h(e("input",{id:"search","onUpdate:modelValue":t[0]||(t[0]=s=>r.search=s),type:"text",class:"form-input",placeholder:"Search tasks...",onInput:B},null,544),[[W,r.search]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"status",class:"form-label"},"Status",-1)),h(e("select",{id:"status","onUpdate:modelValue":t[1]||(t[1]=s=>r.status=s),class:"form-input",onChange:y},t[10]||(t[10]=[e("option",{value:""},"All Status",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"completed"},"Completed",-1)]),544),[[T,r.status]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"priority",class:"form-label"},"Priority",-1)),h(e("select",{id:"priority","onUpdate:modelValue":t[2]||(t[2]=s=>r.priority=s),class:"form-input",onChange:y},t[12]||(t[12]=[e("option",{value:""},"All Priorities",-1),e("option",{value:"high"},"High",-1),e("option",{value:"medium"},"Medium",-1),e("option",{value:"low"},"Low",-1)]),544),[[T,r.priority]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"user",class:"form-label"},"User",-1)),h(e("select",{id:"user","onUpdate:modelValue":t[3]||(t[3]=s=>r.user_id=s),class:"form-input",onChange:y},[t[14]||(t[14]=e("option",{value:""},"All Users",-1)),(n(!0),i(D,null,V(C.value,s=>(n(),i("option",{key:s.id,value:s.id},l(s.name),9,oe))),128))],544),[[T,r.user_id]])])])])]),e("div",re,[e("div",le,[e("div",ie,[w.value?(n(),i("div",ne,t[16]||(t[16]=[e("div",{class:"loading-spinner"},null,-1)]))):c.value.length===0?(n(),i("div",de,[t[17]||(t[17]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),t[18]||(t[18]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No tasks found",-1)),e("p",ue,l(P.value?"Try adjusting your filters.":"No tasks have been created yet."),1)])):(n(),i("div",ce,[e("table",pe,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Task "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Priority "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Created "),e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",me,[(n(!0),i(D,null,V(c.value,s=>{var M,$,A;return n(),i("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ge,[e("div",ve,[e("button",{onClick:U=>L(s),class:"flex-shrink-0 mr-3"},[e("div",{class:_(["w-5 h-5 rounded border-2 flex items-center justify-center transition-colors duration-200",s.status==="completed"?"bg-green-500 border-green-500":"border-gray-300 hover:border-green-400"])},[s.status==="completed"?(n(),i("svg",ye,t[19]||(t[19]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):N("",!0)],2)],8,xe),e("div",fe,[e("div",{class:_(["text-sm font-medium text-gray-900",{"line-through text-gray-500":s.status==="completed"}])},l(s.title),3),e("div",he,l(s.description),1)])])]),e("td",_e,[e("div",be,[e("div",we,[e("span",ke,l(q((M=s.user)==null?void 0:M.name)),1)]),e("div",Te,[e("div",Ce,l(($=s.user)==null?void 0:$.name),1),e("div",Se,l((A=s.user)==null?void 0:A.email),1)])])]),e("td",Fe,[e("span",{class:_(["badge",`priority-${s.priority}`])},l(s.priority),3)]),e("td",Me,[e("span",{class:_(["badge",`status-${s.status}`])},l(s.status),3)]),e("td",$e,l(G(s.created_at)),1),e("td",Ae,[e("button",{onClick:U=>z(s),class:"text-primary-600 hover:text-primary-900 mr-3"}," Edit ",8,Ue),e("button",{onClick:U=>I(s),class:"text-red-600 hover:text-red-900"}," Delete ",8,je)])])}),128))])]),o.value.total>o.value.per_page?(n(),i("div",De,[e("div",Ve,[e("button",{onClick:t[4]||(t[4]=s=>f(o.value.current_page-1)),disabled:o.value.current_page<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,Ne),e("button",{onClick:t[5]||(t[5]=s=>f(o.value.current_page+1)),disabled:o.value.current_page>=o.value.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Next ",8,Pe)]),e("div",Be,[e("div",null,[e("p",Ee,[t[21]||(t[21]=b(" Showing ",-1)),e("span",Le,l(o.value.from),1),t[22]||(t[22]=b(" to ",-1)),e("span",ze,l(o.value.to),1),t[23]||(t[23]=b(" of ",-1)),e("span",He,l(o.value.total),1),t[24]||(t[24]=b(" results ",-1))])]),e("div",null,[e("nav",Ie,[e("button",{onClick:t[6]||(t[6]=s=>f(o.value.current_page-1)),disabled:o.value.current_page<=1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"}," Previous ",8,Re),e("button",{onClick:t[7]||(t[7]=s=>f(o.value.current_page+1)),disabled:o.value.current_page>=o.value.last_page,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"}," Next ",8,qe)])])])])):N("",!0)]))])])])]),j(X,{show:k.value,task:v.value,onClose:F,onSave:H},null,8,["show","task"]),j(Y,{show:g.value,title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.","confirm-text":"Delete",type:"danger",onConfirm:R,onCancel:t[8]||(t[8]=s=>g.value=!1)},null,8,["show"])]))}};export{Oe as default};
