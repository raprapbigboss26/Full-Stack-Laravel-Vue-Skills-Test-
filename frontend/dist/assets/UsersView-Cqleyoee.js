import{bS as M,r as l,p as A,d as r,o as i,f as t,g as v,F as f,s as w,t as o,n as u,bR as y}from"./index-Bx6MUOaO.js";const F={class:"min-h-screen bg-gray-50"},j={class:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8"},B={class:"px-4 sm:px-0"},N={class:"bg-white shadow rounded-lg"},$={class:"px-4 py-5 sm:p-6"},z={key:0,class:"flex justify-center py-8"},D={key:1,class:"text-center py-8"},S={key:2,class:"overflow-hidden"},V={class:"min-w-full divide-y divide-gray-200"},L={class:"bg-white divide-y divide-gray-200"},R={class:"px-6 py-4 whitespace-nowrap"},E={class:"flex items-center"},H={class:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center"},I={class:"text-sm font-medium text-primary-600"},J={class:"ml-4"},P={class:"text-sm font-medium text-gray-900"},q={class:"text-sm text-gray-500"},G={class:"px-6 py-4 whitespace-nowrap"},K={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},O={class:"flex space-x-4"},Q={class:"text-green-600"},W={class:"text-yellow-600"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Y={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Z=["onClick"],tt=["onClick"],et={class:"relative top-20 mx-auto p-5 border w-3/4 max-w-4xl shadow-lg rounded-md bg-white"},st={class:"mt-3"},at={class:"flex items-center justify-between mb-4"},ot={class:"text-lg font-medium text-gray-900"},rt={key:0,class:"text-center py-8"},it={key:1,class:"space-y-3 max-h-96 overflow-y-auto"},nt={class:"flex items-center justify-between"},lt={class:"text-sm font-medium text-gray-900"},dt={class:"text-sm text-gray-500 mt-1"},ct={class:"flex items-center space-x-2 mt-2"},pt={class:"text-sm text-gray-400"},ut={__name:"UsersView",setup(xt){const d=M(),c=l(!1),p=l([]),x=l(!1),m=l(null),n=l([]),k=async()=>{c.value=!0;try{const a=await y.getUsers();p.value=a.data}catch(a){console.error("Failed to fetch users:",a),d.error("Failed to fetch users")}finally{c.value=!1}},b=async a=>{m.value=a,x.value=!0;try{const e=await y.getUserTasks(a.id);n.value=e.data.tasks||[]}catch(e){console.error("Failed to fetch user tasks:",e),d.error("Failed to fetch user tasks"),n.value=[]}},_=()=>{x.value=!1,m.value=null,n.value=[]},U=async a=>{try{const e=!a.is_admin;await y.toggleUserAdmin(a.id,e),a.is_admin=e,d.success(`User ${e?"promoted to":"demoted from"} admin`)}catch(e){console.error("Failed to toggle admin role:",e),d.error("Failed to update user role")}},C=a=>a?a.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2):"U",h=a=>a?new Date(a).toLocaleDateString():"N/A";return A(()=>{k()}),(a,e)=>{var g;return i(),r("div",F,[t("div",j,[e[3]||(e[3]=t("div",{class:"px-4 py-6 sm:px-0"},[t("div",{class:"border-b border-gray-200 pb-5"},[t("h1",{class:"text-3xl font-bold leading-6 text-gray-900"},"Users Management"),t("p",{class:"mt-2 max-w-4xl text-sm text-gray-500"}," Manage all system users and their permissions. ")])],-1)),t("div",B,[t("div",N,[t("div",$,[c.value?(i(),r("div",z,e[0]||(e[0]=[t("div",{class:"loading-spinner"},null,-1)]))):p.value.length===0?(i(),r("div",D,e[1]||(e[1]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No users found",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"No users are currently registered in the system.",-1)]))):(i(),r("div",S,[t("table",V,[e[2]||(e[2]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," User "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Role "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tasks "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Joined "),t("th",{class:"relative px-6 py-3"},[t("span",{class:"sr-only"},"Actions")])])],-1)),t("tbody",L,[(i(!0),r(f,null,w(p.value,s=>(i(),r("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",R,[t("div",E,[t("div",H,[t("span",I,o(C(s.name)),1)]),t("div",J,[t("div",P,o(s.name),1),t("div",q,o(s.email),1)])])]),t("td",G,[t("span",{class:u(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",s.is_admin?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"])},o(s.is_admin?"Administrator":"User"),3)]),t("td",K,[t("div",O,[t("span",null,"Total: "+o(s.tasks_count||0),1),t("span",Q,"Completed: "+o(s.completed_tasks_count||0),1),t("span",W,"Pending: "+o(s.pending_tasks_count||0),1)])]),t("td",X,o(h(s.created_at)),1),t("td",Y,[t("button",{onClick:T=>b(s),class:"text-primary-600 hover:text-primary-900 mr-3"}," View Tasks ",8,Z),s.is_admin?v("",!0):(i(),r("button",{key:0,onClick:T=>U(s),class:"text-purple-600 hover:text-purple-900"}," Make Admin ",8,tt))])]))),128))])])]))])])])]),x.value?(i(),r("div",{key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:_},[t("div",et,[t("div",st,[t("div",at,[t("h3",ot," Tasks for "+o((g=m.value)==null?void 0:g.name),1),t("button",{onClick:_,class:"text-gray-400 hover:text-gray-600"},e[4]||(e[4]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),n.value.length===0?(i(),r("div",rt,e[5]||(e[5]=[t("p",{class:"text-gray-500"},"This user has no tasks.",-1)]))):(i(),r("div",it,[(i(!0),r(f,null,w(n.value,s=>(i(),r("div",{key:s.id,class:"p-4 border border-gray-200 rounded-lg"},[t("div",nt,[t("div",null,[t("h4",lt,o(s.title),1),t("p",dt,o(s.description),1),t("div",ct,[t("span",{class:u(["badge",`priority-${s.priority}`])},o(s.priority),3),t("span",{class:u(["badge",`status-${s.status}`])},o(s.status),3)])]),t("div",pt,o(h(s.created_at)),1)])]))),128))]))])])])):v("",!0)])}}};export{ut as default};
